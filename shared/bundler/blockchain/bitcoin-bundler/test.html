<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bitcoin Bundle Test</title>
</head>
<body>
    <h1>Bitcoin JS Bundle Test</h1>
    <div id="output"></div>
    
    <script src="./dist/bitcoin-bundle.iife.js"></script>
    <script>
        // 번들이 제대로 로드되었는지 테스트
        const output = document.getElementById('output');
        
        if (window.BitcoinJS) {
            output.innerHTML = `
                <p>✅ Bitcoin JS loaded successfully!</p>
                <p>Available modules:</p>
                <ul>
                    ${Object.keys(window.BitcoinJS).filter(key => typeof window.BitcoinJS[key] !== 'function').map(key => `<li>${key}</li>`).join('')}
                </ul>
            `;
            
            // 테스트 1: 니모닉 생성
            try {
                const mnemonic = window.BitcoinJS.generateMnemonic();
                output.innerHTML += `<p>✅ Mnemonic generated: ${mnemonic.split(' ').slice(0, 3).join(' ')}...</p>`;
                
                const isValid = window.BitcoinJS.validateMnemonic(mnemonic);
                output.innerHTML += `<p>✅ Mnemonic valid: ${isValid}</p>`;
            } catch (e) {
                output.innerHTML += `<p>❌ Mnemonic Error: ${e.message}</p>`;
            }
            
            // 테스트 2: HD 지갑 생성 및 주소 생성
            try {
                const mnemonic = window.BitcoinJS.generateMnemonic();
                const network = window.BitcoinJS.networks.testnet;
                const hdWallet = window.BitcoinJS.hdWalletFromMnemonic(mnemonic, network);
                output.innerHTML += `<p>✅ HD Wallet created from mnemonic</p>`;
                
                const account = window.BitcoinJS.generateAddress(hdWallet, 0, network);
                output.innerHTML += `<p>✅ Bitcoin address: ${account.address}</p>`;
            } catch (e) {
                output.innerHTML += `<p>❌ Wallet Error: ${e.message}</p>`;
            }
            
            // 테스트 3: 키페어 생성
            try {
                const keyPair = window.BitcoinJS.ECPair.makeRandom();
                output.innerHTML += `<p>✅ Random keypair generated</p>`;
                
                const { address } = window.BitcoinJS.payments.p2wpkh({ 
                    pubkey: keyPair.publicKey,
                    network: window.BitcoinJS.networks.testnet
                });
                output.innerHTML += `<p>✅ P2WPKH address: ${address}</p>`;
            } catch (e) {
                output.innerHTML += `<p>❌ KeyPair Error: ${e.message}</p>`;
            }
        } else {
            output.innerHTML = '<p>❌ Bitcoin JS not loaded</p>';
        }
    </script>
</body>
</html>